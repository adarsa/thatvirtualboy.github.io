---
layout: post
title: |-
  Configuring Workspace Portal Active-Active failover with a secondary
  data centerGomo
date: '2015-07-20T07:06:00.000-07:00'
author: thatvirtualboy
tags: 
modified_time: '2017-08-03T10:14:47.323-07:00'
blogger_id: tag:blogger.com,1999:blog-733606464149134140.post-8708872479307164725
---

Beginning with Workspace Portal 2.1.1, a configuration option is available to enable a secondary data center to be powered on and active with read-only access. This eliminates any downtime during failover. The read-only configuration lets end users view and launch their apps.<br/><br/><strong>Prerequisites</strong><br/><ul><br/>	<li>A master Workspace instance already deployed in the primary datacenter. For more information on deploying the first Workspace instance see <strong>this post</strong></li><br/>	<li>An IP address and DNS record for the secondary instance</li><br/>	<li>Implementing this configuration requires downtime, so schedule accordingly!</li><br/></ul><br/>In my lab, we have two data centers: Bludhaven and Gotham City. Generally this procedure would be configured in environments with different vCenters in different data center. The master Workspace node is in Gotham City, and the active/active read only failover node will be in Bludhaven. We'll need to export the <strong>master</strong> node as on OVA and import into the secondary data center.<br/><br/>&lt;picture1&gt;<br/><br/><strong>Procedure</strong><br/><ol><br/>	<li>Shut down the <strong>master</strong> Workspace vApp.</li><br/>	<li><strong>Export</strong> as OVA template<br/><ol><br/>	<li>Right Click the vApp and choose All vCenter Actions &gt; Export OVF Template...</li><br/>	<li>If prompted to install the Client Integration Plug-in, do so now.</li><br/>	<li>Name the vApp something that makes it easily identifiable as the secondary</li><br/></ol><br/></li><br/>	<li>After it's deployed, update the vApp Options with the new <strong>Networking Properties</strong><br/>&lt;picture&gt;</li><br/>	<li>Power on <strong>both</strong> the Master and secondary vApps</li><br/>	<li>Login to the Connector Services Admin page on the <strong>Secondary</strong> node<br/><ol><br/>	<li>https://secondary_fqdn:8443 &gt; Connector Services Admin - the Admin password will be the same as configured on the master.<br/>&lt;picture&gt;</li><br/>	<li>Click <strong>Join Domain</strong> and enter the proper info<br/>&lt;Picture join domain&gt;</li><br/>	<li>Setup the Auth Adapters to match that of your master node</li><br/>	<li>If Windows Authentication is enabled on the master, enable it on the secondary node as well</li><br/>	<li>Back on the Admin links page, click the <strong>Appliance Configurator</strong><br/><ol><br/>	<li>Go to <strong>Install Certificate</strong> and duplicate the master's certificate information.</li><br/></ol><br/></li><br/>	<li>Now we'll jump on the console of the <strong>Secondary node</strong> as <strong>root</strong><br/><ol><br/>	<li>Modify <strong>datastore.jdbc.url</strong> in <em>/usr/local/horizon/conf/runtime-config.properties</em> to read the secondary's database info (remember its info is cloned from the master).<br/><br/>&lt;picture&gt;</li><br/>	<li>Now configure it to have read-only access<br/>&lt;picture&gt;</li><br/>	<li>Restart Tomcat Server<br/>&lt;picture&gt;</li><br/></ol><br/></li><br/></ol><br/></li><br/></ol>